<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISKAR</title>

    <meta property="og:title" content="ISKAR - ØªØ·Ø¨ÙŠÙ‚Ùƒ Ø§Ù„Ø±Ù…Ø¶Ø§Ù†ÙŠ">
    <meta property="og:image" content="https://dogc7717-boop.github.io/Ramadan/cover.jpg">
    <meta property="og:description" content="Ù…Ø³Ø¨Ø­Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©ØŒ Ù…ÙˆØ§Ù‚ÙŠØª ØµÙ„Ø§Ø©ØŒ ÙˆØ£Ø°ÙƒØ§Ø± Ù…ØªØ¬Ø¯Ø¯Ø© Ù…Ù† ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù….">
    <meta property="og:type" content="website">

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#B8860B">

    <style>
        :root {
            --gold: #B8860B;
            --neon: 0 0 20px rgba(184, 134, 11, 0.7);
            --glass: rgba(255, 255, 255, 0.08);
        }

        body {
            background: #0a0e17 url('cover.jpg') no-repeat center center fixed;
            background-size: cover;
            color: white; margin: 0; font-family: 'Segoe UI', Tahoma, sans-serif;
            text-align: center; overflow-x: hidden;
        }

        /* Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠ */
        .glass-panel {
            background: rgba(10, 14, 23, 0.8);
            backdrop-filter: blur(15px);
            border: 1px solid var(--gold);
            border-radius: 25px;
            box-shadow: var(--neon);
        }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª */
        #guideModal {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            padding: 30px; z-index: 3000; width: 85%; max-width: 450px;
        }

        /* Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ Ø§Ù„Ù†ÙŠÙˆÙ† */
        .circular-counter {
            width: 210px; height: 210px; border-radius: 50%;
            border: 6px solid var(--gold); margin: 40px auto;
            display: flex; align-items: center; justify-content: center;
            font-size: 4.5rem; box-shadow: var(--neon); cursor: pointer;
            background: var(--glass); transition: 0.2s;
        }
        .circular-counter:active { transform: scale(0.92); }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ù‚ÙˆØ§Ø¦Ù… */
        .btn-neon {
            background: var(--gold); color: white; border: none; padding: 12px 25px;
            border-radius: 15px; cursor: pointer; font-weight: bold; box-shadow: var(--neon);
            margin: 10px;
        }

        .nav-bar {
            position: fixed; bottom: 0; width: 100%; background: rgba(0,0,0,0.9);
            display: flex; justify-content: space-around; padding: 15px 0;
            border-top: 1px solid var(--gold); z-index: 1000;
        }
        .nav-bar span { cursor: pointer; color: var(--gold); font-weight: bold; }
        .nav-bar span.active { text-shadow: var(--neon); color: #fff; }

        .page { padding: 60px 15px 120px; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        table { width: 100%; margin-top: 20px; border-collapse: collapse; background: var(--glass); border-radius: 15px; overflow: hidden; }
        td { padding: 15px; border-bottom: 1px solid rgba(184, 134, 11, 0.2); }
    </style>
</head>
<body>

    <header style="padding:15px; background:rgba(0,0,0,0.8); color:var(--gold); font-size: 1.5rem; font-weight:bold; border-bottom: 1px solid var(--gold);">ISKAR</header>

    <div id="guideModal" class="glass-panel" style="display: none;">
        <h2 style="color: var(--gold);">ğŸ’¡ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ù‡Ø§Ù…Ø©</h2>
        <div style="text-align: right; line-height: 1.8;">
            <p>1ï¸âƒ£ <b>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø°Ø§Ù†:</b> ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.</p>
            <p>2ï¸âƒ£ <b>Ø®Ù„ÙÙŠØ© Ø§Ù„Ù†Ø¸Ø§Ù…:</b> Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø°Ø§Ù† Ø¯Ù‚ÙŠÙ‚ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ù† "ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©" ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù‡Ø§ØªÙÙƒ.</p>
            <p>3ï¸âƒ£ <b>Ø§Ù„ØªØ­Ø¯ÙŠØ«:</b> Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ­Ø¯Ø« Ø§Ù„Ø£Ø°ÙƒØ§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹   .</p>
        </div>
        <button class="btn-neon" onclick="startInstall()">Ø­Ù…Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¢Ù†</button>
    </div>

    <button id="installBtn" class="btn-neon" style="display:none;">ğŸ“¥ ØªØ«Ø¨ÙŠØª  ISKAR</button>

    <main>
        <section id="tasbihPage" class="page">
            <div class="circular-counter" onclick="handleTasbih()">
                <span id="displayNum">0</span>
            </div>
            <div id="tasbihType" style="font-size: 1.3rem; margin-bottom: 20px;">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</div>
            <div style="margin-bottom: 20px;">
                <button class="btn-neon" onclick="setMode('Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡')">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</button>
                <button class="btn-neon" onclick="setMode('Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡')">Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡</button>
                <button class="btn-neon" onclick="setMode('Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±')">Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±</button>
            </div>
            <div class="glass-panel" style="display: inline-block; padding: 10px 20px;">
                ğŸ”Š <input type="checkbox" id="soundToggle" checked> 
                ğŸ“³ <input type="checkbox" id="vibrateToggle" checked>
            </div>
        </section>

        <section id="prayerPage" class="page" style="display:none;">
            <select id="citySelect" onchange="getPrayerTimes()" style="padding:12px; border-radius:10px; background: #000; color: var(--gold); border: 1px solid var(--gold); width: 80%;">
                <optgroup label="Ù…ØµØ±">
                    <option value="Cairo">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
                    <option value="Alexandria">Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</option>
                   <option value="Alexandria">Ø§Ù„Ù…Ù†ØµÙˆØ±Ø©</option>
                   <option value="Alexandria">Ø§Ù„Ù…Ø­Ù„Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ </option>
                   <option value="Alexandria">Ø§Ø³ÙˆØ§Ù†</option>
                   <option value="Alexandria">Ø§Ù„Ø§Ù‚ØµØ±</option>
                </optgroup>
        
                <optgroup label="Ø§Ù„Ø¹Ø§Ù„Ù…">
                    <option value="Mecca">Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©</option>
                    <option value="Dubai">Ø¯Ø¨ÙŠ</option>
                    <option value="Dubai">ÙÙ„Ø³Ø·ÙŠÙ†(Ø§Ù„Ù‚Ø¯Ø³)</option>
                    <option value="Dubai">Ù„ÙŠØ¨ÙŠØ§</option>
                    <option value="Dubai">(Ø±ÙˆÙ…Ø§)Ø§ÙŠØ·Ø§Ù„ÙŠØ§</option>
                    <option value="Dubai">(Ø¨Ø§Ø±ÙŠØ³)ÙØ±Ù†Ø³Ø§</option>
                </optgroup>
            </select>
            <table id="prayerTable"></table>
            <div style="margin-top: 20px;">
                <label>ØµÙˆØª Ø§Ù„Ø£Ø°Ø§Ù†: </label>
                <select id="voiceSelect" style="background:#000; color:#fff; border:1px solid var(--gold);">
                   <option value="Egypt_1.mp3">Egypt 1</option>
                    <option value="Egypt_2.mp3">Egypt 2</option>
                    <option value="Egypt_3.mp3">Egypt 3</option>
                </select>
            </div>
        </section>

        <section id="azkarPage" class="page" style="display:none;">
            <div id="azkarContainer"></div>
        </section>
    </main>

    <nav class="nav-bar">
        <span id="navTasbih" class="active" onclick="showPage('tasbih')">Ø§Ù„Ù…Ø³Ø¨Ø­Ø©</span>
        <span id="navPrayer" onclick="showPage('prayer')">Ø§Ù„Ù…ÙˆØ§Ù‚ÙŠØª</span>
        <span id="navAzkar" onclick="showPage('azkar')">Ø§Ù„Ø£Ø°ÙƒØ§Ø±</span>
    </nav>

    <script>
        let count = 0;
        let currentMode = "Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡";
        let deferredPrompt;

        function showPage(p) {
            document.querySelectorAll('.page').forEach(page => page.style.display = 'none');
            document.querySelectorAll('.nav-bar span').forEach(s => s.classList.remove('active'));
            document.getElementById(p + 'Page').style.display = 'block';
            document.getElementById('nav' + p.charAt(0).toUpperCase() + p.slice(1)).classList.add('active');
            if(p === 'azkar') loadAzkar();
        }

        // Ø§Ù„Ù…Ø³Ø¨Ø­Ø© ÙˆØ§Ù„Ø§Ù‡ØªØ²Ø§Ø²
        function setMode(m) { currentMode = m; document.getElementById('tasbihType').innerText = m; }
        
        function handleTasbih() {
            count++;
            document.getElementById('displayNum').innerText = count;
            if(document.getElementById('vibrateToggle').checked) navigator.vibrate(60);
            if(document.getElementById('soundToggle').checked) {
                let audio = new Audio('https://www.soundjay.com/buttons/sounds/button-16.mp3');
                audio.volume = 0.3; audio.play().catch(()=>{});
            }
            if(Notification.permission === 'default') Notification.requestPermission();
        }

        // Ø§Ù„Ù…ÙˆØ§Ù‚ÙŠØª ÙˆØ§Ù„Ø¹Ù…Ù„ Offline
        async function getPrayerTimes() {
            const city = document.getElementById('citySelect').value;
            try {
                const res = await fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=Egypt&method=4`);
                const data = await res.json();
                const t = data.data.timings;
                localStorage.setItem('iskar_times', JSON.stringify(t));
                renderTable(t);
            } catch {
                const cached = JSON.parse(localStorage.getItem('iskar_times'));
                if(cached) renderTable(cached);
            }
        }

        function renderTable(t) {
            document.getElementById('prayerTable').innerHTML = `
                <tr><td>Ø§Ù„Ø¥Ù…Ø³Ø§Ùƒ</td><td>${t.Imsak}</td></tr>
                <tr><td>Ø§Ù„ÙØ¬Ø±</td><td>${t.Fajr}</td></tr>
                <tr><td>Ø§Ù„Ù…ØºØ±Ø¨</td><td>${t.Maghrib}</td></tr>
            `;
        }

        // Ø§Ù„Ø£Ø°ÙƒØ§Ø± ÙˆØ±Ø¨Ø· Ø§Ù„ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (YAML/JSON)
        async function loadAzkar() {
            let list = ["Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø­Ù…Ø¯Ù‡", "Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¹Ø¸ÙŠÙ…", "Ø§Ù„Ù„Ù‡Ù… ØµÙ„Ù Ø¹Ù„Ù‰ Ù…Ø­Ù…Ø¯", "Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡", "Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡"];
            try {
                // Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø°ÙŠ ÙŠØ­Ø¯Ø«Ù‡ Ø§Ù„Ù€ Action Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
                const res = await fetch('azkar_dynamic.json');
                if(res.ok) {
                    const data = await res.json();
                    if(data.newZikr) list.unshift("ğŸŒŸ Ù…Ù† ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…: " + data.newZikr);
                }
            } catch(e) {}
            
            document.getElementById('azkarContainer').innerHTML = list.map(z => `
                <div class="glass-panel" style="margin: 15px auto; padding: 20px; width: 85%; border-right: 5px solid var(--gold); text-align: right;">
                    ${z}
                </div>
            `).join('');
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù…ÙŠÙ„ PWA
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault(); deferredPrompt = e;
            document.getElementById('installBtn').style.display = 'block';
        });

        document.getElementById('installBtn').onclick = () => {
            document.getElementById('guideModal').style.display = 'block';
        };

        async function startInstall() {
            document.getElementById('guideModal').style.display = 'none';
            if(deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt = null;
                document.getElementById('installBtn').style.display = 'none';
            }
        }

        if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js'); }
        window.onload = () => { getPrayerTimes(); };
    </script>
</body>
    </html>
