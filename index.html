<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Ù…Ø³Ø¨Ø­Ø© Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… ISKAR | PRO</title>
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://dogc7717-boop.github.io/Ramadan/">
    <meta property="og:title" content="Ù…Ø³Ø¨Ø­Ø© Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… ISKAR | PRO">
    <meta property="og:description" content="ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø³Ø¨Ø­Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© ÙˆØ¥Ù…Ø³Ø§ÙƒÙŠØ© Ø±Ù…Ø¶Ø§Ù† 2026 - Ù…ØªØ§Ø­ Ø§Ù„Ø¢Ù† Ù„Ù„ØªØ«Ø¨ÙŠØª Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙˆØ§Ù„Ø¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª">
    
    <meta property="og:image" content="https://dogc7717-boop.github.io/Ramadan/cover.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://dogc7717-boop.github.io/Ramadan/cover.jpg">
    <meta name="theme-color" content="#B8860B">
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">

    <style>
        :root { --gold: linear-gradient(180deg, #FFD700 0%, #B8860B 100%); --bg-dark: #0a0e17; }
        body { margin: 0; padding: 0; background: var(--bg-dark) radial-gradient(circle at center, #1a237e 0%, #0a0e17 100%); color: white; font-family: 'Cairo', sans-serif; display: flex; flex-direction: column; min-height: 100vh; user-select: none; overflow-x: hidden; }
        
        /* Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        #installBtn { display: block; position: fixed; top: 10px; left: 10px; z-index: 2000; padding: 5px 15px; background: #28a745; color: white; border: none; border-radius: 15px; font-size: 0.8rem; font-weight: bold; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        
        /* Ù†Ø§ÙØ°Ø© Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„Ø£Ø°Ø§Ù† */
        .notification-modal { display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-content { background: #1a1a1a; border: 2px solid gold; border-radius: 20px; padding: 30px; text-align: center; width: 85%; max-width: 400px; color: white; box-shadow: 0 0 30px rgba(218, 165, 32, 0.5); }
        .modal-content h2 { color: gold; margin-bottom: 15px; font-size: 1.5rem; }
        .modal-content p { font-size: 1rem; line-height: 1.6; margin-bottom: 20px; }
        .grant-btn { background: var(--gold); color: #331a00; border: none; padding: 12px 25px; border-radius: 25px; font-weight: bold; cursor: pointer; width: 100%; font-size: 1.1rem; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„ØªØ«Ø¨ÙŠØª */
        #loadingModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 3000; justify-content: center; align-items: center; flex-direction: column; }
        .loader { border: 5px solid #f3f3f3; border-top: 5px solid #28a745; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        #updateToast { display: none; position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%); background: linear-gradient(90deg, #28a745, #218838); color: white; padding: 12px 20px; border-radius: 50px; box-shadow: 0 10px 20px rgba(0,0,0,0.4); z-index: 9999; font-size: 0.9rem; font-weight: bold; cursor: pointer; border: 1px solid rgba(255,255,255,0.3); animation: popUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popUp { from { bottom: -50px; opacity: 0; } to { bottom: 90px; opacity: 1; } }

        .zekr-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; margin-top: 50px; }
        .zekr-grid button { background: var(--gold); border: none; border-radius: 12px; padding: 12px 5px; font-weight: bold; color: #331a00; }
        .counter-container { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .main-circle { width: 180px; height: 180px; border: 6px solid #9c27b0; border-radius: 50%; display: flex; justify-content: center; align-items: center; background: rgba(156, 39, 176, 0.1); box-shadow: 0 0 20px rgba(156, 39, 176, 0.7); cursor: pointer; }
        #counter { font-size: 4rem; font-weight: bold; color: #00ff88; }
        
        #prayerPage { padding: 15px; display: none; margin-bottom: 80px; }
        select { width: 100%; padding: 12px; background: #1a237e; color: gold; border: 1px solid gold; border-radius: 10px; margin-bottom: 10px; font-family: 'Cairo'; }
        table { width: 100%; border-collapse: collapse; background: rgba(0,0,0,0.4); border-radius: 10px; }
        td, th { padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.1); text-align: center; }
        
        nav { position: fixed; bottom: 0; width: 100%; background: rgba(0,0,0,0.9); display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid #9c27b0; z-index: 1000; }
        nav span { cursor: pointer; color: #aaa; }
        nav span.active { color: gold; font-weight: bold; }
        .rights { text-align: center; padding: 20px; font-size: 0.7rem; color: rgba(255,215,0,0.4); margin-bottom: 70px; }
    </style>
</head>
<body>

    <button id="installBtn">ğŸ“² ØªØ«Ø¨ÙŠØª</button>
    <div id="loadingModal"><div class="loader"></div><p style="color: white; margin-top: 15px;">Ø¬Ø§Ø±ÙŠ ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...</p></div>
    <div id="updateToast" onclick="location.reload()">âœ¨ ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯ Ù…ØªÙˆÙØ±.. Ø§Ø¶ØºØ· Ù„Ù„ØªÙ†Ø´ÙŠØ·</div>

    <div id="notifModal" class="notification-modal">
        <div class="modal-content">
            <h2>ğŸ”” ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ø£Ø°Ø§Ù†</h2>
            <p>Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ø°Ø§Ù† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù‡Ø§ØªÙ Ù„ØªØ·Ø¨ÙŠÙ‚ <b>"Ø±Ù…Ø¶Ø§Ù† (Ø§Ù„ØªØ³Ø¨ÙŠØ­)"</b>ØŒ ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø¥Ø°Ù† Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª.</p>
            <button class="grant-btn" onclick="enableNotifications()">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø°Ø§Ù† Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
        </div>
    </div>

    <div id="subhaPage">
        <div class="zekr-grid">
            <button onclick="setZekr('Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±')">Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±</button>
            <button onclick="setZekr('Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡')">Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡</button>
            <button onclick="setZekr('Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡')">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</button>
        </div>
        <div class="counter-container">
            <div id="zekrName" style="margin-bottom:10px; font-size: 1.2rem; color: gold;">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</div>
            <div class="main-circle" onclick="addCount()"><div id="counter">0</div></div>
            <div style="margin-top: 15px; display: flex; gap: 15px;">
                <label><input type="checkbox" id="soundToggle" checked> ğŸ”Š ØµÙˆØª</label>
                <label><input type="checkbox" id="vibrateToggle" checked> ğŸ“³ Ø§Ù‡ØªØ²Ø§Ø²</label>
            </div>
            <button style="margin-top:20px; background:none; border:1px solid #444; color:#777; padding:5px 15px; border-radius:8px;" onclick="resetCounter()">ØªØµÙÙŠØ±</button>
        </div>
    </div>

    <div id="prayerPage">
        <h3 style="text-align:center; color:gold;">Ø¥Ù…Ø³Ø§ÙƒÙŠØ© Ø±Ù…Ø¶Ø§Ù† ğŸŒ™</h3>
        <select id="regionSelect" onchange="updateCityList()"><option value="Egypt">Ù…ØµØ± ğŸ‡ªğŸ‡¬</option><option value="World">Ø§Ù„Ø¹Ø§Ù„Ù… ğŸŒ</option></select>
        <select id="citySelect" onchange="getPrayerTimes()"></select>
        
        <label style="color:gold; font-size:0.9rem;">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¤Ø°Ù†:</label>
        <select id="moazenSelect">
            <option value="Egypt.mp3">Ø£Ø°Ø§Ù† Ù…ØµØ± 1</option>
            <option value="Egypt_1.mp3">Ø£Ø°Ø§Ù† Ù…ØµØ± 2</option>
            <option value="Egypt_2.mp3">Ø£Ø°Ø§Ù† Ù…ØµØ± 3</option>
            <option value="Egypt_3.mp3">Ø£Ø°Ø§Ù† Ù…ØµØ± 4</option>
        </select>
        <button id="playBtn" onclick="playAzan()" style="width:100%; padding:12px; background:var(--gold); border:none; border-radius:10px; font-weight:bold; color:#331a00; margin-bottom:15px;">â–¶ï¸ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø£Ø°Ø§Ù†</button>
        
        <table id="prayerTable"><thead><tr><th>Ø§Ù„ØµÙ„Ø§Ø©</th><th>Ø§Ù„Ù…ÙˆØ¹Ø¯</th></tr></thead><tbody id="tableBody"></tbody></table>
    </div>

    <div class="rights">ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© <b style="color:gold">ISKAR</b> Â© 2026</div>

    <nav>
        <span id="navSubha" class="active" onclick="showPage('subha')">ğŸ“¿ Ø§Ù„Ù…Ø³Ø¨Ø­Ø©</span>
        <span id="navPrayer" onclick="showPage('prayer')">ğŸ—“ï¸ Ø§Ù„Ø¥Ù…Ø³Ø§ÙƒÙŠØ©</span>
    </nav>

    <script>
        // --- Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ Ø§Ù„Ù…Ø¹Ø¯Ù„ ---
        let count = 0;
        let audioCtx;
        let currentAzanAudio = null;
        let deferredPrompt;
        window.lastAzanTime = "";

        // 1. Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        function checkNotificationPermission() {
            if ("Notification" in window && Notification.permission === "default") {
                setTimeout(() => {
                    document.getElementById('notifModal').style.display = 'flex';
                }, 2000);
            }
        }

        async function enableNotifications() {
            const permission = await Notification.requestPermission();
            document.getElementById('notifModal').style.display = 'none';
            if (permission === "granted") {
                new Notification("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø°Ø§Ù† Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ âœ…", { icon: "icon.png" });
            }
        }

        function sendAzanNotification(prayerName) {
            if (Notification.permission === "granted") {
                new Notification(`Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ Ø£Ø°Ø§Ù† ${prayerName}`, {
                    body: "Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø©.. Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙÙ„Ø§Ø­",
                    icon: "icon.png",
                    vibrate: [200, 100, 200]
                });
            }
        }

        // 2. ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø³Ø¨Ø­Ø©
        function addCount() {
            count++;
            document.getElementById('counter').innerText = count;
            if(document.getElementById('vibrateToggle').checked && navigator.vibrate) navigator.vibrate(40);
            if(document.getElementById('soundToggle').checked) {
                if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                if (audioCtx.state === 'suspended') audioCtx.resume();
                let osc = audioCtx.createOscillator();
                let gain = audioCtx.createGain();
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.frequency.setValueAtTime(1200, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
                osc.start(); osc.stop(audioCtx.currentTime + 0.05);
            }
        }
        function resetCounter() { count = 0; document.getElementById('counter').innerText = 0; }
        function setZekr(z) { document.getElementById('zekrName').innerText = z; resetCounter(); }

        // 3. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ù† ÙˆØ§Ù„Ù…ÙˆØ§Ù‚ÙŠØª
        function updateCityList() {
            const r = document.getElementById('regionSelect').value;
            const s = document.getElementById('citySelect');
            s.innerHTML = "";
            const egyptCities = [{n:"Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©",v:"Cairo"},{n:"Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©",v:"Alexandria"},{n:"Ø§Ù„Ø¬ÙŠØ²Ø©",v:"Giza"},{n:"Ø§Ù„Ù…Ù†ØµÙˆØ±Ø©",v:"Mansoura"},{n:"Ø·Ù†Ø·Ø§",v:"Tanta"},{n:"Ø£Ø³ÙŠÙˆØ·",v:"Asyut"},{n:"Ø³ÙˆÙ‡Ø§Ø¬",v:"Sohag"},{n:"Ø§Ù„Ø£Ù‚ØµØ±",v:"Luxor"},{n:"Ø£Ø³ÙˆØ§Ù†",v:"Aswan"}];
            const worldCapitals = [{n:"Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© - Ù…ÙƒØ©", v:"Mecca", c:"Saudi Arabia"},{n:"Ø§Ù„ÙƒÙˆÙŠØª", v:"Kuwait City", c:"Kuwait"},{n:"Ø¯Ø¨ÙŠ", v:"Dubai", c:"United Arab Emirates"}];
            const list = r === "Egypt" ? egyptCities : worldCapitals;
            list.forEach(c => {
                let o = document.createElement("option"); o.value = c.v; o.text = c.n;
                if(c.c) o.setAttribute("data-country", c.c);
                s.appendChild(o);
            });
            getPrayerTimes();
        }

        async function getPrayerTimes() {
            const r = document.getElementById('regionSelect').value;
            const s = document.getElementById('citySelect');
            const city = s.value;
            const country = r === "Egypt" ? "Egypt" : s.options[s.selectedIndex].getAttribute("data-country");
            const tb = document.getElementById('tableBody');
            tb.innerHTML = "<tr><td colspan='2'>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>";
            try {
                const res = await fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=${country}&method=4`);
                const d = await res.json();
                const t = d.data.timings;
                const pAr = {"Fajr":"Ø§Ù„ÙØ¬Ø±","Sunrise":"Ø§Ù„Ø´Ø±ÙˆÙ‚","Dhuhr":"Ø§Ù„Ø¸Ù‡Ø±","Asr":"Ø§Ù„Ø¹ØµØ±","Maghrib":"Ø§Ù„Ù…ØºØ±Ø¨","Isha":"Ø§Ù„Ø¹Ø´Ø§Ø¡"};
                tb.innerHTML = "";
                for(let k in pAr) {
                    tb.innerHTML += `<tr><td style="color:gold">${pAr[k]}</td><td class="time-cell">${t[k]}</td></tr>`;
                }
            } catch(e) { tb.innerHTML = "<tr><td colspan='2'>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„</td></tr>"; }
        }

        function playAzan() {
            const btn = document.getElementById('playBtn');
            const file = document.getElementById('moazenSelect').value;
            if (currentAzanAudio && !currentAzanAudio.paused) {
                currentAzanAudio.pause(); currentAzanAudio.currentTime = 0;
                btn.innerText = "â–¶ï¸ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø£Ø°Ø§Ù†"; return;
            }
            currentAzanAudio = new Audio(file);
            btn.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„...";
            currentAzanAudio.play().then(() => btn.innerText = "â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø£Ø°Ø§Ù†")
            .catch(() => btn.innerText = "â–¶ï¸ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø£Ø°Ø§Ù†");
        }

        // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ÙˆÙ‚Øª ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø£Ø°Ø§Ù† Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        setInterval(() => {
            const now = new Date();
            const currentTime = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
            document.querySelectorAll(".time-cell").forEach(cell => {
                if (cell.innerText.trim() === currentTime && window.lastAzanTime !== currentTime) {
                    playAzan();
                    sendAzanNotification(cell.parentElement.cells[0].innerText);
                    window.lastAzanTime = currentTime;
                }
            });
        }, 30000);

        function showPage(p) {
            document.getElementById('subhaPage').style.display = p==='subha'?'block':'none';
            document.getElementById('prayerPage').style.display = p==='prayer'?'block':'none';
            document.getElementById('navSubha').className = p==='subha'?'active':'';
            document.getElementById('navPrayer').className = p==='prayer'?'active':'';
        }

        window.onload = () => {
            updateCityList();
            checkNotificationPermission();
        };

        // Ù†Ø¸Ø§Ù… PWA
        window.addEventListener('beforeinstallprompt', (e) => { e.preventDefault(); deferredPrompt = e; });
        document.getElementById('installBtn').onclick = async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') document.getElementById('installBtn').style.display = 'none';
                deferredPrompt = null;
            } else {
                alert("Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ùˆ Ù…Ø«Ø¨Øª Ø¨Ø§Ù„ÙØ¹Ù„.");
            }
        };
    </script>
</body>
    </html>
